# This configuration file is used by Travis CI to build/test TECA.
language: c++
sudo: required

services:
  - docker

before_install:
  - docker pull aaelbashandy/travis_ci_teca:0.02
  - >
    docker run -v $TRAVIS_BUILD_DIR:/travis_host cascade/teca_ubuntu_18_04 /bin/sh -c 
    "cd TECA_build/; svn co svn://missmarple.lbl.gov/work3/teca/TECA_data TECA_data; 
    cmake -DBUILD_TESTING=ON -DTECA_DATA_ROOT=${WORKDIR}/TECA_data/ 
    -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=/teca-deps/2.1.3/ 
    -DBOOST_ROOT=/teca_deps/2.1.3/include/ -DNETCDF_DIR=/teca_deps/2.1.3/ 
    -DTECA_PYTHON_VERSION=2 /travis_host; make -j8;ctest -I -V"


script: ctest -I -V

after_failure:
  - cat build/Testing/Temporary/LastTest.log
